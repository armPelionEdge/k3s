syntax = "proto3";

message Message {
    enum MessageType {
        Open = 0;
        Close = 1;
        Data = 2;
    }

    MessageType type = 1;

    oneof payload {
        OpenPayload open_payload = 2;
        ClosePayload close_payload = 3;
        bytes data_payload = 4;
    }
}

message OpenPayload {
    string node = 1;
    string address = 2;
}

message ClosePayload {
    enum CloseCode {
        Normal = 0;
        Abnormal = 1;
        ProtocolError = 2;
        NodeRouteNotFound = 3;
    }

    CloseCode code = 1;
    string reason = 2;
}